library(shiny); runApp('~/Desktop/Link to Kullu_desktop/Git/HAP_ungulate_population_ecology/app 1.1.R')
runApp('~/Desktop/Link to Kullu_desktop/Git/HAP_ungulate_population_ecology/app 1.1.R')
runApp('~/Desktop/Link to Kullu_desktop/Git/HAP_ungulate_population_ecology/app 1.1.R')
library(shiny); runApp('~/Desktop/Link to Kullu_desktop/Git/HAP_ungulate_population_ecology/app 1.1.R')
library(shiny); runApp('~/Desktop/Link to Kullu_desktop/Git/HAP_ungulate_population_ecology/app 1.1.R')
library(shiny)
library(BBRecapture)
library(Hmisc)
dos.bay<-function(dos, no.boot, max.pop){
model1 <- BBRecap(dos[, 2:3],
mod=c("Mt"), prior.N = c("Uniform"),
output = c("complete.ML"), neval = max.pop)
N.estimate<-model1$N.hat.mean * mean(dos[,1])
est.arr<-rep(NA, no.boot)
for(i in 1:no.boot){
est.arr[i] <- mean(sample(dos[,1], length(dos[,1]), replace = T)) *
sample(model1$N.range, size = 1, prob = model1$posterior.N)
}
LCI<- quantile(est.arr, 0.025)
UCI<- quantile(est.arr, 0.975)
#hist.plot<-hist(est.arr, xlab = "Population esimate", main = "Posterior distribution of estimated population")
out.put<-c(N.estimate, model1$N.hat.mean, mean(dos[,1]), LCI, UCI, est.arr)
return(out.put)
}
